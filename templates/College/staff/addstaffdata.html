{% extends "College_Home.html" %}
{% block contentRegister %}

{% endblock %}

{% block body %}

<style>
/* Base styles for message container */
.messages {
    list-style-type: none;
    margin: 0;
    padding: 0;
    width: 100%;
    max-width: 700px; /* Optional: adjust to fit your layout */
    margin: 20px auto; /* Center the messages horizontally */
    font-family: Arial, sans-serif;
    position: relative; /* For positioning the close button */
}

/* Base styles for each message */
.messages li {
    padding: 10px 40px 10px 10px; /* Adjusted for close button space */
    margin-bottom: 10px;
    border-radius: 4px;
    color: #fff;
    font-size: 16px;
    position: relative;
}

/* Success message style */
.messages .success {
    background-color: #4CAF50; /* Green */
}

/* Error message style */
.messages .error {
    background-color: #F44336; /* Red */
}

/* Info message style */
.messages .info {
    background-color: #2196F3; /* Blue */
}

/* Warning message style */
.messages .warning {
    background-color: #FF9800; /* Orange */
}

/* Optional: add transition for fade-in effect */
.messages li {
    opacity: 0;
    animation: fadeIn 0.5s forwards;
}

@keyframes fadeIn {
    to {
        opacity: 1;
    }
}

/* Close button style */
.close-btn {
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
}

.close-btn:hover {
    color: #ccc;
}
</style>

<form  method="post" action="{% url 'addStaffData' %}" enctype="multipart/form-data" class="container">
    {% csrf_token %}
    <!-- Staff Details Start -->
    <article class="row mt-3">
        {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                    <li class="{{ message.tags }}">
                        {{ message }}
                        <button class="close-btn" onclick="this.parentElement.style.display='none';">&times;</button>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <div><h3>Staff Details</h3></div>
        <div class="col-md-10"> <!-- Column 1 start -->

            <section class="row">  <!-- Student Details End -->
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="staffId" class="form-label">Staff ID No</label>
                        <input type="text" class="form-control" name="staffId" id="staffId" value="" required />
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="cfmsId" class="form-label">CFMS ID</label>
                        <input type="text" class="form-control" name="cfmsId" id="cfmsId" value="" required />
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="staff_type" class="form-label">Type</label>
                        <select id="staff_type" name="staff_type" class="form-select">
                            <option selected>Choose...</option>
                            <option value="Teaching">Teaching</option>
                            <option value="Non Teaching">Non Teaching</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-1">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="salutation" class="form-label">Salutation</label>
                        <select id="salutation" name="salutation" class="form-select">
                            <option selected>Choose...</option>
                            <option value="Dr.">Dr.</option>
                            <option value="Mr.">Mr.</option>
                            <option value="Ms.">Ms.</option>
                            <option value="Mr.">Mrs.</option>
                            <option value="Ms.">Miss.</option>
                        </select>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="first_name" class="form-label">First Name</label>
                        <input type="text" class="form-control" name="first_name" id="first_name" value="" required />
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="last_name" class="form-label">Last Name</label>
                        <input type="text" class="form-control" name="last_name" id="last_name" value="" required />
                    </div>
                </div>
            </section>

            <section class="row mt-2">
                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="mobile_number" class="form-label">Mobile Number</label>
                        <input type="text" class="form-control" name="mobile_number" id="mobile_number" value="" required />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" name="email" id="email" value="" />
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="mb-2">
                        <div class="form-outline" data-mdb-input-init>
                            <label for="date_of_birth" class="form-label">Date of Birth</label>
                            <input class="form-control" type="date" id="date_of_birth" name="date_of_birth">
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <label for="gender" class="form-label">Gender</label>
                    <div class="form-outline mt-2" data-mdb-input-init>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="genderMale" value="Male">
                            <label class="form-check-label" for="genderMale">Male</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="genderFemale" value="Female">
                            <label class="form-check-label" for="genderFemale">Female</label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="row mt-3">
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="doorNo" class="form-label">Door No.</label>
                        <input type="text" class="form-control" name="doorNo" id="doorNo" placeholder="door No." value="" />
                    </div>
                </div>
            <!-- Address Start -->
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="village" class="form-label">Village/Town</label>
                        <input type="text" class="form-control" name="village" id="village" placeholder="village" value="" />
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="street" class="form-label">Street</label>
                        <input type="text" class="form-control" name="street" id="street" placeholder="street" value="" />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="mandal" class="form-label">Mandal</label>
                        <input type="text" class="form-control" name="mandal" id="mandal" value="" />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="state" class="form-label">State</label>
                        <select id="state" name="state" class="form-select" required>
                            <option value="" selected>Choose...</option>
                            {% for state in states %}
                                <option value="{{ state.id }}">{{ state.state_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>            
            </section>
            <section class="row mt-3">
                <div class="col-md-3">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="district" class="form-label">District</label>
                        <select id="district" name="district" class="form-select" required>
                            <option selected>Choose...</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-outline" data-mdb-input-init>
                        <label for="pincode" class="form-label">Pincode</label>
                        <input type="text" class="form-control" name="pincode" id="pincode" value="" />
                    </div>
                </div>    
            </section>
            <!-- Address End -->

        </div> <!-- Column 1 End -->

        <div class="col-md-2"> <!-- Column 2 Start -->
            <div class="card">
                <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_640.png" class="card-img-top" alt="Profile Image">
                <div class="card-body">
                    <div class="mb-2">
                        <label for="profile_file" class="form-label">Profile Image</label>
                        <input class="form-control" type="file" id="profile_file" name="profile_file">
                    </div>
                </div>
            </div>
        </div> <!-- Column 2 End -->
    </article>
    <!-- Staff Details End -->
    <!-- Staff Status Start -->
    <section class="row mt-3" id="staffstatus">
        <div><h3>Designation</h3></div>
        <div class="col-md-2">
            <div class="form-outline" data-mdb-input-init>
                <label for="designation" class="form-label">Designation</label>
                <input type="text" class="form-control" name="designation" id="designation" value="" />
            </div>
        </div> 
        <div class="col-md-2" id="dept_container" style="display: none;">
            <div class="form-outline" data-mdb-input-init>
                <label for="dept" class="form-label">Department</label>
                <select id="dept" name="dept" class="form-select">
                    <option value="" selected>Choose...</option>
                    {% for dept in depts %}
                        <option value="{{ dept.id }}">{{ dept.departmentName }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-outline" data-mdb-input-init>
                <label for="date_of_appointment_service" class="form-label">DOJ in Govt. Service</label>
                <input class="form-control" type="date" id="date_of_appointment_service" name="date_of_appointment_service">
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-outline" data-mdb-input-init>
                <label for="date_of_appointment" class="form-label">DOJ in College</label>
                <input class="form-control" type="date" id="date_of_appointment" name="date_of_appointment" required>
            </div>
        </div>
        <div class="col-md-2">
            <label for="ishod" class="form-label">HOD</label>
            <div class="form-outline mt-2" data-mdb-input-init>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="ishod" id="true" value="True" required>
                    <label class="form-check-label" for="true">yes</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="ishod" id="false" value="False" required>
                    <label class="form-check-label" for="false">no</label>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-outline" data-mdb-input-init>
                <label for="status" class="form-label">Staff Status</label>
                <select id="status" name="status" class="form-select" required>
                    <option selected value="">Choose...</option>
                    <option value="Working">Working</option>
                    <option value="Transferred">Transferred</option>
                    <option value="Departed">Departed</option>
                </select>
            </div>
        </div>
    </section>
<script>
        document.addEventListener('DOMContentLoaded', function () {
            const staffstatusdiv = document.getElementById('staffstatus');
            const staffstatus = document.getElementById('status');
            const staff_type = document.getElementById('staff_type');
            const dept = document.getElementById('dept_container');
            
            staff_type.addEventListener('change', function(){
            
                // display none existing 'department' element if it displays block
                if(dept.style.display){
                    dept.style.display = "none";
                }
                if (staff_type.value === 'Teaching'){
                    dept.style.display = "block";
                }
            })
            
            if (!staffstatus || !staffstatusdiv) {
                console.error("Element with ID 'staffstatus' or 'status' not found.");
                return;
            }
            
            staffstatus.addEventListener('change', function () {

                // Remove existing 'salary' element if it exists
                const salary = document.getElementById('salary');
                if (salary) {
                    salary.parentElement.parentElement.remove();
                }
                // Remove existing 'date_of_exite' element if it exists
                const existingExitdate = document.getElementById('date_of_exite');
                if (existingExitdate) {
                    existingExitdate.parentElement.parentElement.remove();
                }
                
                if (staffstatus.value === 'Working') {
                    const div = document.createElement('div');
                    div.className = 'col-md-2';
                    div.innerHTML = `
                        <div class="form-outline" data-mdb-input-init>
                            <label for="salary" class="form-label">Salary</label>
                            <input class="form-control" type="text" id="salary" name="salary" required>
                        </div>`;
                    staffstatusdiv.appendChild(div);
                }
                
                else if (staffstatus.value === 'Transferred' || staffstatus.value === 'Departed') {
                    const div = document.createElement('div');
                    div.className = 'col-md-2';
                    div.innerHTML = `
                        <div class="form-outline" data-mdb-input-init>
                            <label for="date_of_exite" class="form-label">DOE from College</label>
                            <input class="form-control" type="date" id="date_of_exite" name="date_of_exite">
                        </div>`;
                    staffstatusdiv.appendChild(div);
                }
            });
        });
    </script>
    <!-- Staff Status End -->

    <!-- Aadhar Start -->
    <section class="row mt-3">
        <div><h3>Staff Documents</h3></div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="aadhar_number" class="form-label">Aadhar Number</label>
                <input type="text" pattern="[0-9]{12}" class="form-control" name="aadhar_number" id="aadhar_number" value="" />
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="aadhar_file" class="form-label">Aadhar file</label>
                <input class="form-control" type="file" id="aadhar_file" name="aadhar_file">
            </div>
        </div>
    </section>
    <!-- Aadhar End -->

    <!-- Bank Details Start -->
    <section class="row mt-3">
        <div><h3>Bank Details</h3></div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="bank_account_num" class="form-label">Bank Account Number</label>
                <input type="text" class="form-control" name="bank_account_num" id="bank_account_num" value="" />
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="bank_name" class="form-label">Bank Name</label>
                <input type="text" class="form-control" name="bank_name" id="bank_name" value="" />
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="branch_name" class="form-label">Branch Name</label>
                <input type="text" class="form-control" name="branch_name" id="branch_name" value="" />
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-outline" data-mdb-input-init>
                <label for="ifsc_num" class="form-label">IFSC Number</label>
                <input type="text" class="form-control" name="ifsc_num" id="ifsc_num" value="" />
            </div>
        </div>
    </section>
    <!-- Bank Details End -->

    <div class="col-12 mt-5 mb-5">
        <button class="btn btn-primary" type="submit" data-mdb-ripple-init>Submit form</button>
    </div>
</form>
<script>
    $(document).ready(function() {
        // Fetch districts based on selected state
        $('#state').change(function() {
            var stateId = $(this).val();
            if (stateId) {
                $.ajax({
                    url: "{% url 'get_districts' 0 %}".replace('0', stateId),
                    method: "GET",
                    success: function(data) {
                        var districtSelect = $('#district');
                        districtSelect.empty();
                        districtSelect.append('<option value="" selected>Choose...</option>');
                        data.forEach(function(district) {
                            districtSelect.append('<option value="' + district.id + '">' + district.district_name + '</option>');
                        });
                    }
                });
            } else {
                $('#district').empty();
                $('#district').append('<option value="" selected>Choose...</option>');
            }
        });
    });
</script>

{% endblock %}
